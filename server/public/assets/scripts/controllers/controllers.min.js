/*! health_tracker 2016-02-16 */
myApp.controller("AddConditionController",["$scope","$http","$uibModalInstance","$localstorage",function(a,b,c,d){a.conditions=[],a.condition={};var e={patient_id:d.get("patient_id")};a.insertCondition=function(a){a.patient_id=e.patient_id,b.post("/conditions/conditions",a).then(function(a){c.close("ok")})},a.ok=function(b){a.insertCondition(b)},a.cancel=function(){c.dismiss("cancel")}}]),myApp.controller("AddMedicationController",["$scope","$http","$uibModalInstance","$localstorage",function(a,b,c,d){a.medications=[],a.medication={};var e={patient_id:d.get("patient_id")};a.insertMedication=function(a){a.patient_id=e.patient_id,b.post("/medications/medications",a).then(function(a){c.close("ok")})},a.ok=function(b){a.insertMedication(b)},a.cancel=function(){c.dismiss("cancel")}}]),myApp.controller("AddPatientController",["$scope","$http","$uibModalInstance",function(a,b,c){a.patients=[],a.patient={};var d={patient_id:1};a.insertPatient=function(a){a.patient_id=d.patient_id,b.post("/patient/patients",a).then(function(a){c.close("ok")})},a.ok=function(b){console.log("ok function ",b),a.insertPatient(b)},a.cancel=function(){c.dismiss("cancel")}}]),myApp.controller("ConditionsController",["$scope","$http","$uibModal","$localstorage",function(a,b,c,d){a.conditions=[],a.condition={},a.gridOptions={};var e={patient_id:d.get("patient_id")};a.getConditions=function(){return b.get("/conditions/conditions",{params:e}).then(function(b){a.conditions=b.data})},a.loadData=function(){var b=a.getConditions();b.then(function(){a.gridOptions={columnDefs:[{name:"Action",cellEditableCondition:!1,cellTemplate:'<button ng-click="grid.appScope.editCondition(row.entity)" id="editCondition" class="btn btn-xs btn-primary">Edit</button><button ng-click="grid.appScope.deleteCondition(row.entity)" id="editCondition" class="btn btn-xs btn-danger">Delete</button>'},{name:"condition_id",displayName:"Condition ID"},{name:"name",displayName:"Name"},{name:"current_ind",displayName:"Current Ind"},{name:"patient_id",displayName:"Patient ID"}],data:a.conditions}})},a.loadData(),a.addCondition=function(){var b=c.open({animation:a.animationsEnabled,templateUrl:"../assets/views/templates/addcondition.html",controller:"AddConditionController",size:"sm",resolve:{items:function(){return"something"}}});b.result.then(function(b){"ok"==b&&a.loadData()},function(){})},a.editCondition=function(b){console.log("condition arg ",b);var d=c.open({animation:a.animationsEnabled,templateUrl:"../assets/views/templates/editcondition.html",controller:"EditConditionController",size:"sm",resolve:{items:function(){return b}}});d.result.then(function(b){"ok"==b&&a.loadData()},function(){a.loadData()})},a.deleteCondition=function(d){var e=c.open({animation:a.animationsEnabled,templateUrl:"../assets/views/templates/deleteconfirm.html",controller:"DeleteConfirmController",size:"sm",resolve:{items:function(){return d}}});e.result.then(function(c){"ok"==c&&b["delete"]("/conditions/delete"+d.condition_id).then(function(b){a.loadData()})},function(){})}}]),myApp.controller("DailyDataController",["$scope","$http","$localstorage",function(a,b,c){a.medications=[],a.conditions=[],a.selectedDate={},a.gridOptions={};var d={patient_id:c.get("patient_id")};a.selectedDate.date||(a.selectedDate.date=new Date),a.getConditions=function(){b.get("/dailydata/conditions",{params:d}).then(function(b){a.conditions=b.data})},a.getConditions(),a.getMedications=function(){b.get("/dailydata/medications",{params:d}).then(function(b){a.medications=b.data})},a.getMedications(),a.submitConditions=function(c){for(var e=0;e<c.length;e++){var f={};c[e].addCheckbox&&(f.entry_date=a.selectedDate.date,f.patient_id=d.patient_id,f.condition_id=c[e].condition_id,f.add_value=c[e].addValue,b.post("/dailydata/conditions",f).then(function(b){a.getConditions()}))}},a.submitMedications=function(c){for(var e=0;e<c.length;e++){var f={};c[e].addCheckbox&&(f.entry_date=a.selectedDate.date,f.patient_id=d.patient_id,f.medication_id=c[e].medication_id,f.dose_given=c[e].suggested_dose,f.uom=c[e].uom,b.post("/dailydata/medications",f).then(function(b){a.getMedications()}))}}}]),myApp.controller("DashboardController",["$scope","$http","$localstorage",function(a,b,c){a.medications=[],a.conditions=[],a.allconditions=[],a.conditionChartData={},a.filterData={},a.selectedCondition={},a.filterData.patient_id=c.get("patient_id"),a.filterData.end_date||(a.filterData.end_date=new Date),a.filterData.start_date||(a.filterData.start_date=new Date(a.filterData.end_date.getTime()-6048e5)),a.getAllConditions=function(){return b.get("/dashboard/allconditions",{params:a.filterData}).then(function(b){a.allconditions=b.data,a.selectedCondition=a.allconditions[0]})},a.loadDropDown=function(){var b=a.getAllConditions();b.then(function(){a.getMedications(),a.getConditions()})},a.loadDropDown(),a.loadData=function(){a.getMedications(),a.getConditions()},a.getMedications=function(){a.filterData.condition_id=a.selectedCondition.condition_id,b.get("/dashboard/medications",{params:a.filterData}).then(function(b){a.medications=b.data})},a.getConditions=function(){a.filterData.condition_id=a.selectedCondition.condition_id,b.get("/dashboard/conditions",{params:a.filterData}).then(function(b){a.conditions=b.data,a.conditionChartData={chart:{caption:"Condition Chart",subCaption:a.selectedCondition.name,xAxisName:"Date",yAxisName:"Value",lineThickness:"2",paletteColors:"#0075c2",baseFontColor:"#333333",baseFont:"Helvetica Neue,Arial",captionFontSize:"14",subcaptionFontSize:"14",subcaptionFontBold:"0",showBorder:"0",bgColor:"#ffffff",showShadow:"0",canvasBgColor:"#ffffff",canvasBorderAlpha:"0",divlineAlpha:"100",divlineColor:"#999999",divlineThickness:"1",divLineIsDashed:"1",divLineDashLen:"1",divLineGapLen:"1",showXAxisLine:"1",xAxisLineThickness:"1",xAxisLineColor:"#999999",showAlternateHGridColor:"0"},data:a.conditions}})}}]),myApp.controller("DeleteConfirmController",["$scope","$uibModalInstance","items",function(a,b,c){console.log("items ",c),a.items=c,a.ok=function(){b.close("ok")},a.cancel=function(){b.dismiss("cancel")}}]),myApp.controller("EditConditionController",["$scope","$http","$uibModalInstance","items",function(a,b,c,d){console.log("items ",d),a.conditions=d,a.editCondition=function(a){return b.put("/conditions/conditions",a).then(function(a){})},a.ok=function(b){var d=a.editCondition(b);d.then(function(){c.close("ok")})},a.cancel=function(){c.dismiss("cancel")}}]),myApp.controller("EditMedicationController",["$scope","$http","$uibModalInstance","items",function(a,b,c,d){a.meds=d,a.editMedication=function(a){return b.put("/medications/medications",a).then(function(a){})},a.ok=function(b){var d=a.editMedication(b);d.then(function(){c.close("ok")})},a.cancel=function(){c.dismiss("cancel")}}]),myApp.controller("EditPatientController",["$scope","$http","$uibModalInstance","items",function(a,b,c,d){d.dob=new Date(d.dob),a.patient=d,a.editPatient=function(a){return b.put("/patient/patients",a).then(function(a){})},a.ok=function(b){var d=a.editPatient(b);d.then(function(){c.close("ok")})},a.cancel=function(){c.dismiss("cancel")}}]),myApp.controller("HeaderController",["$scope","$http","$uibModal","$localstorage","$route",function(a,b,c,d,e){a.patients=[],a.selectedPatient={},d.get("patient_id")||d.set("patient_id",1),this.openMenu=function(a,b){originatorEv=b,a(b)},a.getAllPatients=function(){return b.get("/patient/allpatients").then(function(b){a.patients=b.data})},a.loadDropDown=function(){var b=a.getAllPatients();b.then(function(){for(var b=d.get("patient_id"),c=-1,e=0,f=a.patients.length;f>e;e++)if(a.patients[e].patient_id==b){c=e;break}a.selectedPatient=a.patients[e]})},a.loadDropDown(),a.addPatient=function(){var b=c.open({animation:a.animationsEnabled,templateUrl:"../assets/views/templates/addpatient.html",controller:"AddPatientController",size:"sm",resolve:{items:function(){return"something"}}});b.result.then(function(b){"ok"==b&&a.loadDropDown()},function(){})},a.editPatient=function(b){var d=c.open({animation:a.animationsEnabled,templateUrl:"../assets/views/templates/editpatient.html",controller:"EditPatientController",size:"sm",resolve:{items:function(){return b}}});d.result.then(function(b){"ok"==b&&a.loadDropDown()},function(){a.loadDropDown()})},a.changePatient=function(b){d.set("patient_id",b.patient_id),a.selectedPatient=b,e.reload()}}]),myApp.controller("MedicationsController",["$scope","$http","$uibModal","$localstorage",function(a,b,c,d){a.medications=[],a.medication={},a.gridOptions={};var e={patient_id:d.get("patient_id")};a.getMedications=function(){return b.get("/medications/medications",{params:e}).then(function(b){console.log("medications ",b.data),a.medications=b.data})},a.loadData=function(){var b=a.getMedications();b.then(function(){a.gridOptions={columnDefs:[{name:"Action",cellEditableCondition:!1,cellTemplate:'<button ng-click="grid.appScope.editMedication(row.entity)" id="editMedication" class="btn btn-xs btn-primary">Edit</button><button ng-click="grid.appScope.deleteMedication(row.entity)" class="btn btn-xs btn-danger">Delete</button>'},{name:"medication_id",displayName:"Medication ID"},{name:"name",displayName:"Name"},{name:"suggested_dose",displayName:"Suggested Dose"},{name:"suggested_timing",displayName:"Suggested Timing"},{name:"uom",displayName:"Unit of Measure"},{name:"current_ind",displayName:"Current Ind"},{name:"patient_id",displayName:"Patient ID"}],data:a.medications}})},a.loadData(),a.addMedication=function(){var b=c.open({animation:a.animationsEnabled,templateUrl:"../assets/views/templates/addmedication.html",controller:"AddMedicationController",size:"sm",resolve:{items:function(){return"something"}}});b.result.then(function(b){"ok"==b&&a.loadData()},function(){})},a.editMedication=function(b){var d=c.open({animation:a.animationsEnabled,templateUrl:"../assets/views/templates/editmedication.html",controller:"EditMedicationController",size:"sm",resolve:{items:function(){return b}}});d.result.then(function(b){"ok"==b&&a.loadData()},function(){a.loadData()})},a.deleteMedication=function(d){var e=c.open({animation:a.animationsEnabled,templateUrl:"../assets/views/templates/deleteconfirm.html",controller:"DeleteConfirmController",size:"sm",resolve:{items:function(){return d}}});e.result.then(function(c){"ok"==c&&(console.log("deleting med...",d),b["delete"]("/medications/delete"+d.medication_id).then(function(b){a.loadData()}))},function(){})}}]),myApp.controller("NavController",["$scope","$location",function(a,b){a.isActive=function(a){return a===b.path()},a.go=function(a){b.path(a)}}]);